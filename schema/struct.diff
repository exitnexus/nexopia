
INSERT INTO `config` ( `id` , `name` , `value` , `comments` )
VALUES (
'', 'picmodexamdir', '/picmodexam/', 'directory relative to the docroot to save pic mod exam imgs'
);

CREATE TABLE picmodexam.examconfig (
 var varchar(20) NOT NULL,
 data varchar(255) NOT NULL,
 PRIMARY KEY BTREE (var ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
CREATE TABLE picmodexam.exampiccategories (
 catid tinyint(3) unsigned NOT NULL auto_increment,
 catlabel varchar(40) NOT NULL,
 percused tinyint(3) unsigned NOT NULL,
 PRIMARY KEY BTREE (catid ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
CREATE TABLE picmodexam.exampics (
 picid int(10) unsigned NOT NULL auto_increment,
 picfilename varchar(44) NOT NULL,
 addedtime int(10) unsigned NOT NULL,
 forceinclude enum('y','n') NOT NULL DEFAULT 'n',
 modanswer enum('u','x','a','d','f') NOT NULL DEFAULT 'u',
 modcategory tinyint(3) unsigned NOT NULL,
 modreason varchar(255) NOT NULL,
 picgender enum('male','female') NOT NULL DEFAULT 'male',
 picage tinyint(3) unsigned NOT NULL,
 piccomment varchar(255) NOT NULL,
 approvecnt int(10) unsigned NOT NULL,
 denycnt int(10) unsigned NOT NULL,
 PRIMARY KEY BTREE (picid ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
CREATE TABLE picmodexam.examresults (
 examid int(10) unsigned NOT NULL auto_increment,
 userid int(10) unsigned NOT NULL,
 examtimestart int(10) unsigned NOT NULL,
 examtimeend int(10) unsigned NOT NULL,
 examscore tinyint(3) unsigned NOT NULL,
 examstatus enum('pending','init','cancel','pass','fail') NOT NULL DEFAULT 'pending',
 approvegood tinyint(3) unsigned NOT NULL,
 denybad tinyint(3) unsigned NOT NULL,
 approvebad tinyint(3) unsigned NOT NULL,
 denygood tinyint(3) unsigned NOT NULL,
 frozenexam text NOT NULL,
 PRIMARY KEY BTREE (examid ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
CREATE TABLE picmodexam.examusers (
 userid int(10) unsigned NOT NULL,
 examallowed enum('y','n') NOT NULL DEFAULT 'n',
 PRIMARY KEY BTREE (userid ASC)
) TYPE = MyISAM ROW_FORMAT = Fixed ;
ALTER TABLE picmodexam.exampics ADD COLUMN acceptcnt int(10) unsigned NOT NULL  AFTER piccomment;
ALTER TABLE picmodexam.exampics DROP COLUMN approvecnt;
ALTER TABLE picmodexam.exampics MODIFY COLUMN modanswer enum('unknown','retired','accept','deny','instant fail') NOT NULL DEFAULT 'unknown';
ALTER TABLE picmodexam.exampics MODIFY COLUMN picfilename varchar(48) NOT NULL;
ALTER TABLE picmodexam.examresults MODIFY COLUMN examstatus enum('waiting','invite sent','invite declined','invite revoked','exam started','passed','failed') NOT NULL DEFAULT 'waiting';
ALTER TABLE picmodexam.exampiccategories ADD COLUMN catcnt tinyint(3) unsigned NOT NULL  AFTER catlabel;
ALTER TABLE picmodexam.exampiccategories DROP COLUMN percused;
ALTER TABLE picmodexam.exampics MODIFY COLUMN modcategory tinyint(3) unsigned NOT NULL DEFAULT '1';
ALTER TABLE picmodexam.examresults MODIFY COLUMN examscore float unsigned NOT NULL;
ALTER TABLE picmodexam.examusers ADD COLUMN posid smallint(5) unsigned NOT NULL  AFTER userid;
ALTER TABLE picmodexam.examusers DROP COLUMN examallowed;
ALTER TABLE picmodexam.examresults ADD INDEX userid /* BTREE */ (userid ASC);
ALTER TABLE picmodexam.examusers ADD INDEX posid /* BTREE */ (userid ASC,posid ASC);
ALTER TABLE picmodexam.exampics ADD INDEX picfilename /* BTREE */ (picfilename ASC);
ALTER TABLE picmodexam.examusers DROP INDEX posid;
ALTER TABLE picmodexam.exampics ADD INDEX isretired /* BTREE */ (isretired ASC);
ALTER TABLE picmodexam.exampics ADD INDEX modcategory /* BTREE */ (modcategory ASC,modanswer ASC,isretired ASC,picgender ASC);
ALTER TABLE picmodexam.examresults ADD INDEX isarchived /* BTREE */ (isarchived ASC);
ALTER TABLE picmodexam.exampics ADD INDEX modanswer /* BTREE */ (modanswer ASC);

CREATE TABLE main.userfiles (
 userid int(10) unsigned NOT NULL,
 PRIMARY KEY BTREE (userid ASC)
) TYPE = MyISAM ROW_FORMAT = Fixed ;
ALTER TABLE main.userfiles ADD COLUMN publiclisting enum('private','public','loggedin','friends') NOT NULL DEFAULT 'private'  AFTER userid;
CREATE TABLE msgs.msgtextold (
 id int(10) unsigned NOT NULL auto_increment,
 date int(11) NOT NULL,
 compressed enum('n','y') NOT NULL DEFAULT 'n',
 html enum('n','y') NOT NULL DEFAULT 'n',
 hash varchar(16) binary NOT NULL,
 msg text NOT NULL,
 PRIMARY KEY BTREE (id ASC),
 INDEX date BTREE (date ASC),
 INDEX hash BTREE (hash ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic max_rows=4294967295 avg_row_length=50;
ALTER TABLE users.users ADD COLUMN defaultloc int(11)  AFTER defaultsex;
ALTER TABLE users.users ADD COLUMN fileslisting enum('private','public','loggedin','friends') NOT NULL DEFAULT 'public'  AFTER forumjumplastpost;

ALTER TABLE weblog.blog ADD COLUMN parse_bbcode enum('y','n') NOT NULL DEFAULT 'y'  AFTER parse_html;
ALTER TABLE msgs.msgtext DROP COLUMN compressed;
ALTER TABLE msgs.msgtext DROP COLUMN hash;
ALTER TABLE msgs.msgtext DROP INDEX hash;
ALTER TABLE msgs.msgtext MODIFY COLUMN id int(10) unsigned NOT NULL;
CREATE TABLE usersdb.usercounter (
 userid int(10) unsigned NOT NULL,
 area tinyint(3) unsigned NOT NULL,
 max int(10) unsigned NOT NULL,
 PRIMARY KEY BTREE (userid ASC,area ASC)
) TYPE = MyISAM ROW_FORMAT = Fixed ;

ALTER TABLE msgsdb.msgtext ADD COLUMN parse_bbcode enum('y','n') NOT NULL DEFAULT 'y'  AFTER parse_html;
ALTER TABLE usersdb.usercounter ADD COLUMN id int(10) unsigned NOT NULL  FIRST;
ALTER TABLE usersdb.usercounter DROP COLUMN userid;
ALTER TABLE usersdb.usercounter DROP PRIMARY KEY;
ALTER TABLE usersdb.usercounter ADD PRIMARY KEY /* BTREE */ (id ASC,area ASC);
ALTER TABLE usersdb.users ADD COLUMN parse_bbcode enum('y','n') NOT NULL DEFAULT 'y'  AFTER fileslisting;

ALTER TABLE articlesdb.articles ADD COLUMN parse_bbcode enum('y','n') NOT NULL DEFAULT 'y'  AFTER nextcomment;

ALTER TABLE articlesdb.commentstext ADD COLUMN parse_bbcode enum('y','n') NOT NULL DEFAULT 'y'  AFTER nmsg;

ALTER TABLE commentsdb.usercommentstext ADD COLUMN parse_bbcode enum('y','n') NOT NULL DEFAULT 'y'  AFTER nmsg;

ALTER TABLE forumdb.forumposts ADD COLUMN parse_bbcode enum('y','n') NOT NULL DEFAULT 'y'  AFTER msg;

CREATE TABLE profiledb.profileblocks (
 userid int(11) NOT NULL,
 blocktitle varchar(32) NOT NULL,
 blockcontent text NOT NULL,
 blockorder tinyint(3) unsigned NOT NULL,
 INDEX userid BTREE (userid ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
ALTER TABLE articlesdb.articles DROP COLUMN parse_html;
ALTER TABLE articlesdb.commentstext DROP COLUMN parse_html;
ALTER TABLE forumdb.forumposts DROP COLUMN parse_html;
ALTER TABLE msgsdb.msgtext DROP COLUMN parse_html;
ALTER TABLE weblogdb.blog DROP COLUMN parse_html;
ALTER TABLE commentsdb.usercommentstext DROP COLUMN parse_html;
DROP TABLE weblogdb.blogsubscriptions;
ALTER TABLE usersdb.users ADD COLUMN bbcode_editor enum('y','n') NOT NULL DEFAULT 'n'  AFTER parse_bbcode;
ALTER TABLE usersdb.users DROP COLUMN parse_html;
ALTER TABLE db.news MODIFY COLUMN title varchar(255) NOT NULL;
ALTER TABLE usersdb.users ADD COLUMN recentvisitlistthumbs enum('y','n') NOT NULL DEFAULT 'y'  AFTER friendslistthumbs;
CREATE TABLE polldb.comments (
 id int(10) unsigned NOT NULL auto_increment,
 itemid int(10) unsigned NOT NULL,
 authorid int(10) unsigned NOT NULL,
 author varchar(12) NOT NULL,
 time int(11) unsigned NOT NULL,
 PRIMARY KEY BTREE (id ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
CREATE TABLE polldb.commentstext (
 id int(10) unsigned NOT NULL auto_increment,
 msg text NOT NULL,
 nmsg text NOT NULL,
 parse_bbcode enum('y','n') NOT NULL DEFAULT 'y',
 PRIMARY KEY BTREE (id ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
DROP TABLE usersdb.usercounter;
CREATE TABLE scrumdb.acl_flags (
 flag_id int(11) NOT NULL auto_increment,
 flag_descr varchar(200) NOT NULL,
 PRIMARY KEY BTREE (flag_id ASC)
) TYPE = InnoDB ROW_FORMAT = Dynamic ;
CREATE TABLE scrumdb.product_backlog (
 prod_bklg_id int(11) NOT NULL auto_increment,
 task_headline longtext NOT NULL,
 est_hours float NOT NULL,
 priority int(11) NOT NULL,
 status varchar(50) NOT NULL,
 detailed_description longtext,
 PRIMARY KEY BTREE (prod_bklg_id ASC)
) TYPE = InnoDB ROW_FORMAT = Dynamic ;
CREATE TABLE scrumdb.sprint_backlog (
 sp_bklg_id int(11) NOT NULL auto_increment,
 prod_bklg_id int(11) NOT NULL,
 sp_id int(11) NOT NULL,
 status varchar(20) NOT NULL DEFAULT 'OPEN',
 PRIMARY KEY BTREE (sp_bklg_id ASC),
 UNIQUE prod_bklg_id BTREE (prod_bklg_id ASC),
 INDEX sp_id BTREE (sp_id ASC)
) TYPE = InnoDB ROW_FORMAT = Dynamic ;
CREATE TABLE scrumdb.sprint_backlog_subtasks (
 sp_bklg_stsk_id int(11) NOT NULL auto_increment,
 sp_bklg_id int(11) NOT NULL,
 subtask_headline longtext NOT NULL,
 detailed_description longtext,
 initial_est_hours float NOT NULL,
 user_id int(11),
 status varchar(50) NOT NULL,
 PRIMARY KEY BTREE (sp_bklg_stsk_id ASC),
 INDEX sp_bklg_id BTREE (sp_bklg_id ASC),
 INDEX user_id BTREE (user_id ASC)
) TYPE = InnoDB ROW_FORMAT = Dynamic ;
CREATE TABLE scrumdb.sprints (
 sp_id int(11) NOT NULL auto_increment,
 start date NOT NULL DEFAULT '0000-00-00',
 end date NOT NULL DEFAULT '0000-00-00',
 comment longtext,
 PRIMARY KEY BTREE (sp_id ASC)
) TYPE = InnoDB ROW_FORMAT = Dynamic ;
CREATE TABLE scrumdb.subtask_daily_est (
 est_id int(11) NOT NULL auto_increment,
 sp_bklg_stsk_id int(11) NOT NULL,
 day_number int(11) NOT NULL,
 day_est_hours float NOT NULL,
 comments longtext,
 PRIMARY KEY BTREE (est_id ASC),
 INDEX sp_bklg_stsk_id BTREE (sp_bklg_stsk_id ASC)
) TYPE = InnoDB ROW_FORMAT = Dynamic ;
CREATE TABLE scrumdb.user_acl (
 user_id int(11) NOT NULL,
 flag_id int(11) NOT NULL,
 PRIMARY KEY BTREE (user_id ASC,flag_id ASC),
 INDEX flag_id BTREE (flag_id ASC)
) TYPE = InnoDB ROW_FORMAT = Fixed ;
CREATE TABLE scrumdb.users (
 user_id int(11) NOT NULL auto_increment,
 login varchar(50) NOT NULL,
 password varchar(41) NOT NULL,
 full_name varchar(250),
 email varchar(250),
 PRIMARY KEY BTREE (user_id ASC),
 UNIQUE login BTREE (login ASC)
) TYPE = InnoDB ROW_FORMAT = Dynamic ;
CREATE TABLE usersdb.usercounter (
 id int(10) unsigned NOT NULL,
 area tinyint(3) unsigned NOT NULL,
 max int(10) unsigned NOT NULL,
 PRIMARY KEY BTREE (id ASC,area ASC)
) TYPE = MyISAM ROW_FORMAT = Fixed ;
CREATE TABLE masterdb.useraccounts (
 userid int(10) unsigned NOT NULL,
 type tinyint(3) unsigned NOT NULL,
 accountid int(10) unsigned NOT NULL,
 serverid tinyint(3) unsigned NOT NULL,
 PRIMARY KEY BTREE (userid ASC,type ASC),
 UNIQUE accounts BTREE (type ASC,accountid ASC)
) TYPE = MyISAM ROW_FORMAT = Fixed ;
CREATE TABLE masterdb.usernames (
 userid int(10) unsigned NOT NULL,
 username char(12) NOT NULL,
 live enum('y'),
 PRIMARY KEY BTREE (userid ASC),
 UNIQUE username BTREE (username ASC,live ASC)
) TYPE = MyISAM ROW_FORMAT = Fixed row_format=FIXED;
CREATE TABLE masterdb.userpasswords (
 userid int(10) unsigned NOT NULL,
 password varchar(32) NOT NULL,
 PRIMARY KEY BTREE (userid ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
ALTER TABLE masterdb.useraccounts DROP PRIMARY KEY;
ALTER TABLE masterdb.useraccounts DROP INDEX accounts;
ALTER TABLE masterdb.useraccounts ADD PRIMARY KEY /* BTREE */ (type ASC,accountid ASC);
ALTER TABLE masterdb.useraccounts ADD INDEX accounttypes /* BTREE */ (userid ASC,type ASC);
ALTER TABLE masterdb.usernames MODIFY COLUMN userid int(10) unsigned NOT NULL auto_increment;
CREATE TABLE bannerdb.bannercampaigns (
 id int(10) unsigned NOT NULL auto_increment,
 clientid int(10) unsigned NOT NULL,
 maxviews int(11) NOT NULL,
 maxclicks int(11) NOT NULL,
 viewsperday int(11) NOT NULL,
 clicksperday int(11) NOT NULL,
 viewsperuser int(10) unsigned NOT NULL,
 limitbyhour enum('y','n') NOT NULL DEFAULT 'y',
 startdate int(11) NOT NULL,
 enddate int(11) NOT NULL,
 payrate smallint(5) unsigned NOT NULL,
 paytype tinyint(3) unsigned NOT NULL,
 title varchar(32) NOT NULL,
 dateadded int(11) NOT NULL,
 age text NOT NULL,
 sex text NOT NULL,
 loc text NOT NULL,
 page text NOT NULL,
 interests text NOT NULL,
 enabled enum('y','n') NOT NULL DEFAULT 'y',
 bannerids text NOT NULL,
 PRIMARY KEY BTREE (id ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
ALTER TABLE bannerdb.banners ADD COLUMN campaignid int(10) unsigned NOT NULL  AFTER passbacks;
ALTER TABLE picsdb.modvoteslog ADD COLUMN points tinyint(3) unsigned NOT NULL  AFTER description;
ALTER TABLE bannerdb.bannercampaigns DROP COLUMN bannerids;
CREATE TABLE scrumdb.product_backlog_dep (
 prod_bklg_id int(11) NOT NULL,
 dep_prod_bklg_id int(11) NOT NULL,
 PRIMARY KEY BTREE (prod_bklg_id ASC,dep_prod_bklg_id ASC),
 INDEX dep_prod_bklg_id BTREE (dep_prod_bklg_id ASC)
) TYPE = InnoDB ROW_FORMAT = Fixed ;
ALTER TABLE bannerdb.banners MODIFY COLUMN payrate smallint(6) NOT NULL DEFAULT '-1';
ALTER TABLE bannerdb.banners MODIFY COLUMN paytype tinyint(4) NOT NULL DEFAULT '-1';
ALTER TABLE bannerdb.banners MODIFY COLUMN paytype tinyint(3) unsigned NOT NULL;
ALTER TABLE bannerdb.bannercampaigns ADD COLUMN refresh smallint(6) NOT NULL DEFAULT '30'  AFTER enabled;
ALTER TABLE bannerdb.banners MODIFY COLUMN refresh smallint(6) NOT NULL DEFAULT '-1';
ALTER TABLE usersdb.users ADD COLUMN screenres varchar(9) NOT NULL DEFAULT '1024x768'  AFTER bbcode_editor;
ALTER TABLE usersdb.users ADD COLUMN screenformat varchar(6) NOT NULL DEFAULT 'html'  AFTER screenres;
ALTER TABLE usersdb.users DROP COLUMN screenres;
ALTER TABLE usersdb.users MODIFY COLUMN screenformat varchar(20) NOT NULL DEFAULT 'html1024x768';
CREATE TABLE db.skins (
 id int(10) unsigned NOT NULL auto_increment,
 userid int(10) unsigned NOT NULL,
 name varchar(20) NOT NULL,
 cssloc varchar(255) NOT NULL,
 PRIMARY KEY BTREE (id ASC),
 INDEX userid BTREE (userid ASC)
) TYPE = MyISAM ROW_FORMAT = Dynamic ;
ALTER TABLE moddb.admin ADD COLUMN editskins enum('n','y') NOT NULL DEFAULT 'n'  AFTER wiki;
ALTER TABLE db.skins ADD COLUMN active enum('n','y') NOT NULL DEFAULT 'n'  AFTER cssloc;
