<html>
<head>
	<title>Nexopia: Skin Editor</title>
	<link rel="stylesheet" type="text/css" href="{$site.static_files_url}/profile/skin_edit/css/preview_main.css" />
	
</head>
<body style="background-color: rgb(190, 190, 190);">

	<!-- YUI things that are needed here -->
	<script type="text/javascript" src="{$site.static_files_url}/yui/build/utilities/utilities.js"></script>
	<script type="text/javascript" src="{$site.static_files_url}/yui/build/slider/slider.js"></script>
	<script type="text/javascript" src="{$site.static_files_url}/yui/build/colorpicker/colorpicker-beta.js"></script>
	<script type="text/javascript" src="{$site.static_files_url}/yui/build/dragdrop/dragdrop.js"></script>
	<script type="text/javascript" src="{$site.static_files_url}/yui/build/animation/animation.js"></script>
	
	<script type="text/javascript" src="{core_js}"></script>
	
<div id="skin_edit_wrapper">
	
	<div class="header_block">
		Header
	</div>
	
	<div id="right">
		<img src="{$site.static_files_url}/profile/skin_edit/images/profile_user_picture.jpg" />
		<div class="primary_block" style="margin-top: 5px;">
			<h1>Vitals</h1>
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</div>
		<div class="primary_block">
			<h1>About</h1>
			<img src="{$site.static_files_url}/profile/icons/star.png" class="custom_color_icon_alpha" style="color: #f67832;" />
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</div>
		<div class="primary_block">
			<h1>More About</h1>
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
		</div>
		<div class="primary_block">
			<h1>Comments</h1>
			<div class="secondary_block">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
			</div>
			<div class="secondary_block">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
			</div>
		</div>
	</div>
	
	<div id="left">
		<div class="utility_block">
			<h1>My_Name</h1>
			<img src="{$site.static_files_url}/profile/icons/addfriend.gif" class="custom_color_icon" style="color: #f67832;" />
			Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
		</div>
		
		<div class="primary_block">
			<h1>Friends</h1>
			<div class="secondary_block">
				Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
			</div>
		</div>
		
		<div class="primary_block">
			<h1>Friends</h1>
			<div class="secondary_block">
				Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
			</div>
		</div>
	</div>
	
</div>
<script type="text/javascript">
<![CDATA[

YAHOO.util.Event.on(window, 'load', function(e)
{
	var icons = YAHOO.util.Dom.getElementsByClassName("custom_color_icon");
		
	for(i = 0; i < icons.length; i++)
	{
		if(!YAHOO.env.ua.ie)
		{
			var canvas = document.createElement('canvas');
			
			canvas.width = icons[i].width;
			canvas.height = icons[i].height;
			
			YAHOO.util.Dom.addClass(canvas, "custom_color_icon");
			YAHOO.util.Dom.setStyle(canvas, "color", YAHOO.util.Dom.getStyle(icons[i], "color"));
			icons[i].parentNode.replaceChild(canvas, icons[i]);
			canvas.maskImage = icons[i];
			icons[i] = canvas;
		}
		
		icons[i].setColor = function(color)
		{
			if(!YAHOO.env.ua.ie)
			{
				if (!this.getContext) return;
				var ctx = this.getContext('2d');
				
				ctx.globalCompositeOperation = "source-over";
				ctx.clearRect(0,0,this.width,this.height);
				
				ctx.drawImage(this.maskImage, 0, 0, this.width, this.height);
				
				ctx.globalCompositeOperation = "source-in";
				
				ctx.fillStyle = color;
				ctx.fillRect(0,0,this.width,this.height);
			}
			else
			{
				// Convert color to a 6 digit hex value
				var rgb = /^rgb\((\d*)\D*(\d*)\D*(\d*)\)\D*$/;
				var hhh = /^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/;
				var hhhhhh = /^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/;
				
				if(match = color.match(rgb))
				{
					match.shift();
					
					for(j = 0; j < match.length; j++)
						match[j] = parseInt(match[j]);
				}
				else
				{
					if(match = color.match(hhh))
					{
						match.shift();
						for(j = 0; j < match.length; j++)
							match[j] = match[j].concat(match[j]);
					}
					else if(match = color.match(hhhhhh))
					{
						match.shift();
					}
			
					for(j = 0; j < match.length; j++)
						match[j] = parseInt(match[j],16);
				}
				
				match[0] = match[0].toString(16);
				match[1] = match[1].toString(16);
				match[2] = match[2].toString(16);
				
				if(match[0].length == 1)
					match[0] = "0"+match[0];
				if(match[1].length == 1)
					match[1] = "0"+match[1];
				if(match[2].length == 1)
					match[2] = "0"+match[2];
				
				// Use this new color value in the IE filter
				this.style.filter ="filter: progid:DXImageTransform.Microsoft.MaskFilter(color=#000000) progid:DXImageTransform.Microsoft.MaskFilter(color=#"+match.join("")+");";
			}
		}
		
		icons[i].setColor(YAHOO.util.Dom.getStyle(icons[i], "color"));
	}
});


/********** Custom Icons with Alpha in IE **********/

/*
	NOTE:
		Due to a DOCTYPE problem in IE custom icons in IE will be rendered to display as a block element.
		For consistancy I have forced other browsers to do the same.
*/

YAHOO.util.Event.on(window, 'load', function(e)
{
	var icons = YAHOO.util.Dom.getElementsByClassName("custom_color_icon_alpha", "img");
	
	for(var i = 0; i < icons.length; i++)
	{
		if(!YAHOO.env.ua.ie)
		{
			var canvas = document.createElement('canvas');
			
			canvas.width = icons[i].width;
			canvas.height = icons[i].height;
			
			YAHOO.util.Dom.addClass(canvas, "custom_color_icon_alpha");
			YAHOO.util.Dom.setStyle(canvas, "display", "block");
			YAHOO.util.Dom.setStyle(canvas, "color", YAHOO.util.Dom.getStyle(icons[i], "color"));
			icons[i].parentNode.replaceChild(canvas, icons[i]);
			canvas.maskImage = icons[i];
			icons[i] = canvas;
		}
		else
		{
			var wrapper = document.createElement('div');
		
			icons[i].maskImageSrc = icons[i].src;
			icons[i].width = YAHOO.util.Dom.getRegion(icons[i]).right - YAHOO.util.Dom.getRegion(icons[i]).left;
			icons[i].height = YAHOO.util.Dom.getRegion(icons[i]).bottom - YAHOO.util.Dom.getRegion(icons[i]).top;
			
			icons[i].src = Site.staticFilesURL + "/core/custom_color_icon/transparent.gif";
			
			icons[i].style.filter ="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + icons[i].maskImageSrc + "', sizingMethod='scale');";
			
			YAHOO.util.Dom.setStyle(wrapper, "width", icons[i].width);
			YAHOO.util.Dom.setStyle(wrapper, "height", icons[i].height);
			
			YAHOO.util.Dom.addClass(wrapper, "custom_color_icon_alpha");
			YAHOO.util.Dom.removeClass(icons[1], "custom_color_icon_alpha");
			YAHOO.util.Dom.setStyle(wrapper, "color", YAHOO.util.Dom.getStyle(icons[i], "color"));
			
			icons[i].parentNode.replaceChild(wrapper, icons[i]);
			wrapper.appendChild(icons[i]);
			
			icons[i] = wrapper;
		}
		
		icons[i].setColor = function(color)
		{
			if(!YAHOO.env.ua.ie)
			{
				if (!this.getContext) return;
				var ctx = this.getContext('2d');
				
				ctx.globalCompositeOperation = "source-over";
				ctx.clearRect(0,0,this.width,this.height);
				
				ctx.drawImage(this.maskImage, 0, 0, this.width, this.height);
				
				ctx.globalCompositeOperation = "source-in";
				
				ctx.fillStyle = color;
				ctx.fillRect(0,0,this.width,this.height);
			}
			else
			{
				// Convert color to a 6 digit hex value
				var rgb = /^rgb\((\d*)\D*(\d*)\D*(\d*)\)\D*$/;
				var hhh = /^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/;
				var hhhhhh = /^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/;
				
				if(match = color.match(rgb))
				{
					match.shift();
					
					for(j = 0; j < match.length; j++)
						match[j] = parseInt(match[j]);
				}
				else
				{
					if(match = color.match(hhh))
					{
						match.shift();
						for(j = 0; j < match.length; j++)
							match[j] = match[j].concat(match[j]);
					}
					else if(match = color.match(hhhhhh))
					{
						match.shift();
					}
			
					for(j = 0; j < match.length; j++)
						match[j] = parseInt(match[j],16);
				}
				
				match[0] = match[0].toString(16);
				match[1] = match[1].toString(16);
				match[2] = match[2].toString(16);
				
				if(match[0].length == 1)
					match[0] = "0"+match[0];
				if(match[1].length == 1)
					match[1] = "0"+match[1];
				if(match[2].length == 1)
					match[2] = "0"+match[2];
				
				// Use this new color value in the IE filter
				this.style.filter ="filter: progid:DXImageTransform.Microsoft.MaskFilter(color=#000000) progid:DXImageTransform.Microsoft.MaskFilter(color=#"+match.join("")+");";
			}
		}
		
		icons[i].setColor(YAHOO.util.Dom.getStyle(icons[i], "color"));
	}
});


]]>
</script>
</body>
</html>